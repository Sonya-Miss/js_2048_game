const t=new class{constructor(t){this.state=t||this.createInitialState(),this.score=0,this.status="idle",this.start()}createInitialState(){return Array.from({length:4},()=>[,,,,].fill(0))}generateRandomTile(){let t=[];if(this.state.forEach((e,s)=>{e.forEach((e,a)=>{0===e&&t.push([s,a])})}),0===t.length)return this.updateStatus();let[e,s]=t[Math.floor(Math.random()*t.length)];this.state[e][s]=.9>Math.random()?2:4}updateStatus(){this.status=this.state.flat().includes(2048)?"win":this.canMove()?"playing":"lose"}canMove(){return this.state.some((t,e)=>t.some((s,a)=>0===s||a<3&&s===t[a+1]||e<3&&s===this.state[e+1][a]))}move(t){let e=t=>{let e=t.filter(Boolean),s=[];for(let t=0;t<e.length;t++)e[t]===e[t+1]?(s.push(2*e[t]),this.score+=2*e[t],t++):s.push(e[t]);return[...s,...Array(4-s.length).fill(0)]},s=JSON.stringify(this.state);({left:()=>{this.state=this.state.map(e)},right:()=>{this.state=this.state.map(t=>e(t.reverse())).map(t=>t.reverse())},up:()=>{this.transpose(),this.state=this.state.map(e),this.transpose()},down:()=>{this.transpose(),this.state=this.state.map(t=>e(t.reverse())).map(t=>t.reverse()),this.transpose()}})[t](),s!==JSON.stringify(this.state)&&(this.generateRandomTile(),this.updateStatus())}transpose(){this.state=this.state[0].map((t,e)=>this.state.map(t=>t[e]))}start(){this.score=0,this.state=this.createInitialState(),this.status="playing",this.generateRandomTile(),this.generateRandomTile()}restart(){this.start()}getState(){return this.state}getScore(){return this.score}getStatus(){return this.status}},e=document.querySelectorAll(".field-cell"),s=document.querySelector(".game-score"),a=document.querySelector(".button.start"),r=document.querySelector(".message-lose"),i=document.querySelector(".message-win"),n=document.querySelector(".message-start");function o(){t.getState().flat().forEach((t,s)=>{let a=e[s];a.textContent=0===t?"":t,a.className=`field-cell field-cell--${t}`}),s.textContent=t.getScore();let a=t.getStatus();"win"===a?(i.classList.remove("hidden"),r.classList.add("hidden")):"lose"===a?(r.classList.remove("hidden"),i.classList.add("hidden")):(i.classList.add("hidden"),r.classList.add("hidden"))}a.addEventListener("click",()=>{t.restart(),o(),a.textContent="Restart",n.classList.add("hidden"),a.classList.add("restart"),a.classList.remove("hidden")}),document.addEventListener("keydown",e=>{if("playing"===t.getStatus()){switch(e.key){case"ArrowLeft":t.move("left");break;case"ArrowRight":t.move("right");break;case"ArrowUp":t.move("up");break;case"ArrowDown":t.move("down")}o()}});
//# sourceMappingURL=index.003ba463.js.map
